import{a0 as x,r as o,k as L}from"./BzxOPHBW.js";const c={priceRange:{min:0,max:1e7,minLimit:0,maxLimit:1e7},areaRange:{min:0,max:100,minLimit:0,maxLimit:100}},y=x("apartments",()=>{const r=o([]),n=o(!1),e=o({...c}),u=L(()=>{let a=r.value;return e.value.selectedRooms!=null&&(a=a.filter(t=>t.rooms===e.value.selectedRooms)),e.value.priceRange&&(a=a.filter(t=>t.price>=e.value.priceRange.min&&t.price<=e.value.priceRange.max)),e.value.areaRange!=null&&(a=a.filter(t=>t.area>=e.value.areaRange.min&&t.area<=e.value.areaRange.max)),a}),v=()=>{e.value.priceRange.minLimit=Math.min(...r.value.map(a=>a.price)),e.value.priceRange.min=e.value.priceRange.minLimit,e.value.priceRange.maxLimit=Math.max(...r.value.map(a=>a.price)),e.value.priceRange.max=e.value.priceRange.maxLimit,e.value.areaRange.minLimit=Math.min(...r.value.map(a=>a.area)),e.value.areaRange.min=e.value.areaRange.minLimit,e.value.areaRange.maxLimit=Math.max(...r.value.map(a=>a.area)),e.value.areaRange.max=e.value.areaRange.maxLimit},p=()=>{e.value={...c}},g=async()=>{const a=await s();if(r.value.length){r.value=[...r.value,...a];return}try{n.value=!0;const i=await fetch("https://api.jsonbin.io/v3/b/68a58bc4d0ea881f405e08cc/latest/",{headers:{"X-Master-Key":"$2a$10$q3OjSW5amSsYUdTLXU0NbulFD7VuYPK8uXevNdugfG6mj5XNUqQC."}}).then(m=>m.json());if(!i?.record)throw new Error("Ошибка загрузки данных");const l=r.value.length?await s():i.record;r.value=[...r.value,...l],v()}catch(t){r.value=[...r.value,...a],console.error("Ошибка загрузки квартир:",t)}finally{n.value=!1}},s=async()=>{const a=[];for(let t=1;t<=4;t++)for(let i=1;i<=17;i+=3){const l=t===1?33:t===2?45:t===3?65:85,m=Math.floor(Math.random()*20)-10,f=Math.max(l+m,30),h=t===1?55e5:t===2?85e5:t===3?125e5:189e5,R=Math.floor(Math.random()*2e6)-1e6,d=Math.max(h+R,5e6);a.push({id:r.value.length+1,name:`${t}-комнатная №${100+r.value.length+a.length}`,rooms:t,area:f,floor:i,price:d,layoutImage:`/images/layout-${t}k.png`})}return a.slice(0,20)};return{apartments:r,isLoading:n,filteredApartments:u,filters:e,loadApartments:g,resetFilters:p}});export{y as u};
